pipeline {
    agent any
    environment {
      docker = '192.168.0.248'
    }
    
    stages {
        stage('Stage1') {
          steps {
            //aquaMicroscanner imageName: 'alpine:latest', notCompliesCmd: 'exit 1', onDisallowed: 'ignore', outputFormat: 'json'
                sh 'ssh root@$docker "docker ps -a"'
            }
          }
    stage('Creat directory') {
          steps {
              sh 'ssh root@$docker "mkdir /root/Dockerfile"'
            }
          }
    stage('Copy Dockerfile') {
          steps {
              sh 'scp ./aquascan root@$docker:/Dockerfile/aquascan'
            }
          }       
    stage('Docker pull nginx') {
          steps {
              //sh 'ssh root@$docker "docker pull nginx"'
              sh 'ssh root@$docker "docker build --build-arg=token=MWI3MTI1NDM4NTM2 --no-cache ."'
            }
          }
    stage('Image Check') {
          steps {
              sh 'ssh root@$docker "docker images"'
              sh 'ssh root@$docker "rm -rf /Dockerfile"'
              //sh 'ssh root@$docker "docker rmi 53f3fd8007f7"'
            }
          }       
        }
      }
